<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CleanMove - Cleaning & Moving Services</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Demo data
        const demoUsers = [
            { id: 1, username: 'demo', password: 'password', name: 'Demo User', email: 'demo@example.com' },
            { id: 2, username: 'provider1', password: 'password', name: 'Pro Cleaner', email: 'cleaner@example.com', role: 'provider' },
            { id: 3, username: 'provider2', password: 'password', name: 'Pro Mover', email: 'mover@example.com', role: 'provider' }
        ];

        const demoServices = [
            { id: 1, type: 'cleaning', name: 'Basic House Cleaning', price: 80, duration: '2 hours', providerId: 2 },
            { id: 2, type: 'cleaning', name: 'Deep Cleaning', price: 150, duration: '4 hours', providerId: 2 },
            { id: 3, type: 'cleaning', name: 'Move-Out Cleaning', price: 200, duration: '5 hours', providerId: 2 },
            { id: 4, type: 'moving', name: 'Small Move (Studio/1BR)', price: 250, duration: '3 hours', providerId: 3 },
            { id: 5, type: 'moving', name: 'Medium Move (2-3BR)', price: 450, duration: '5 hours', providerId: 3 },
            { id: 6, type: 'moving', name: 'Large Move (4BR+)', price: 800, duration: '8 hours', providerId: 3 }
        ];

        const demoReviews = [
            { id: 1, serviceId: 1, userId: 1, rating: 5, comment: 'Excellent service! Very thorough cleaning.', date: '2025-05-10' },
            { id: 2, serviceId: 4, userId: 1, rating: 4, comment: 'Great movers, very careful with my furniture.', date: '2025-05-12' }
        ];

        const demoChats = [
            { id: 1, participants: [1, 2], messages: [
                { sender: 2, text: 'Hello! I see you've booked a cleaning service. Do you have any special requests?', timestamp: '2025-05-09 14:30' },
                { sender: 1, text: 'Yes, please focus on the kitchen and bathrooms primarily.', timestamp: '2025-05-09 14:35' }
            ]},
            { id: 2, participants: [1, 3], messages: [
                { sender: 1, text: 'Hi, do you provide packing services as well?', timestamp: '2025-05-11 10:15' },
                { sender: 3, text: 'Yes, we do! We can add that to your booking for an additional fee.', timestamp: '2025-05-11 10:20' }
            ]}
        ];

        const demoBookings = [
            { id: 1, userId: 1, serviceId: 1, date: '2025-05-20', time: '10:00', status: 'confirmed', address: '123 Main St, Anytown' },
            { id: 2, userId: 1, serviceId: 4, date: '2025-06-01', time: '09:00', status: 'pending', address: '123 Main St, Anytown' }
        ];

        // Main App Component
        function App() {
            const [currentUser, setCurrentUser] = useState(null);
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [currentPage, setCurrentPage] = useState('home');
            const [activeService, setActiveService] = useState('cleaning');
            const [bookings, setBookings] = useState(demoBookings);
            const [serviceToBook, setServiceToBook] = useState(null);
            const [bookingDetails, setBookingDetails] = useState({
                date: '',
                time: '',
                address: ''
            });
            const [activeChatId, setActiveChatId] = useState(null);
            const [chatMessage, setChatMessage] = useState('');

            const login = (username, password) => {
                const user = demoUsers.find(u => u.username === username && u.password === password);
                if (user) {
                    setCurrentUser(user);
                    setIsLoggedIn(true);
                    return true;
                }
                return false;
            };

            const logout = () => {
                setCurrentUser(null);
                setIsLoggedIn(false);
                setCurrentPage('home');
            };

            const bookService = (service) => {
                setServiceToBook(service);
                setCurrentPage('booking');
            };

            const confirmBooking = () => {
                if (!bookingDetails.date || !bookingDetails.time || !bookingDetails.address) {
                    alert('Please fill out all booking details');
                    return;
                }
                
                const newBooking = {
                    id: bookings.length + 1,
                    userId: currentUser.id,
                    serviceId: serviceToBook.id,
                    date: bookingDetails.date,
                    time: bookingDetails.time,
                    address: bookingDetails.address,
                    status: 'pending'
                };
                
                setBookings([...bookings, newBooking]);
                setCurrentPage('bookings');
                setBookingDetails({
                    date: '',
                    time: '',
                    address: ''
                });
            };

            const getUserBookings = () => {
                if (!currentUser) return [];
                return bookings.filter(booking => booking.userId === currentUser.id);
            };

            const getServiceById = (id) => {
                return demoServices.find(service => service.id === id);
            };

            const getProviderById = (id) => {
                return demoUsers.find(user => user.id === id);
            };

            const getReviewsForService = (serviceId) => {
                return demoReviews.filter(review => review.serviceId === serviceId);
            };

            const getUserChats = () => {
                if (!currentUser) return [];
                return demoChats.filter(chat => chat.participants.includes(currentUser.id));
            };

            const getChatParticipantName = (chat) => {
                const otherParticipantId = chat.participants.find(id => id !== currentUser.id);
                const participant = demoUsers.find(user => user.id === otherParticipantId);
                return participant ? participant.name : 'Unknown User';
            };

            const sendMessage = () => {
                if (!chatMessage.trim() || !activeChatId) return;
                
                const updatedChats = demoChats.map(chat => {
                    if (chat.id === activeChatId) {
                        return {
                            ...chat,
                            messages: [
                                ...chat.messages,
                                {
                                    sender: currentUser.id,
                                    text: chatMessage,
                                    timestamp: new Date().toLocaleString()
                                }
                            ]
                        };
                    }
                    return chat;
                });
                
                // In a real app, we would update the state properly, but for this demo we'll just pretend
                setChatMessage('');
                // For demo purposes, simulate a response
                setTimeout(() => {
                    const chat = demoChats.find(c => c.id === activeChatId);
                    const providerId = chat.participants.find(id => id !== currentUser.id);
                    
                    const updatedChat = {
                        ...chat,
                        messages: [
                            ...chat.messages,
                            {
                                sender: providerId,
                                text: "Thanks for your message! I'll get back to you soon.",
                                timestamp: new Date().toLocaleString()
                            }
                        ]
                    };
                    
                    const index = demoChats.findIndex(c => c.id === activeChatId);
                    demoChats[index] = updatedChat;
                    // Force a re-render
                    setActiveChatId(null);
                    setTimeout(() => setActiveChatId(activeChatId), 1);
                }, 1000);
            };

            // Components
            const Navigation = () => (
                <nav className="bg-indigo-600 text-white p-4">
                    <div className="container mx-auto flex justify-between items-center">
                        <h1 className="text-2xl font-bold cursor-pointer" onClick={() => setCurrentPage('home')}>CleanMove</h1>
                        <div className="flex space-x-4">
                            <button onClick={() => setCurrentPage('home')} className="hover:text-indigo-200">Home</button>
                            {isLoggedIn ? (
                                <>
                                    <button onClick={() => setCurrentPage('services')} className="hover:text-indigo-200">Services</button>
                                    <button onClick={() => setCurrentPage('bookings')} className="hover:text-indigo-200">My Bookings</button>
                                    <button onClick={() => setCurrentPage('chats')} className="hover:text-indigo-200">Messages</button>
                                    <button onClick={logout} className="hover:text-indigo-200">Logout</button>
                                    <span className="font-semibold">Hi, {currentUser.name}</span>
                                </>
                            ) : (
                                <button onClick={() => setCurrentPage('login')} className="hover:text-indigo-200">Login</button>
                            )}
                        </div>
                    </div>
                </nav>
            );

            const HomePage = () => (
                <div className="container mx-auto p-4">
                    <div className="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
                        <div className="relative">
                            <div className="absolute inset-0 bg-gradient-to-r from-indigo-500 to-purple-600 opacity-90"></div>
                            <div className="relative p-8 text-white text-center">
                                <h2 className="text-4xl font-bold mb-4">Professional Home Services</h2>
                                <p className="text-xl mb-6">Cleaning & Moving Services Made Easy</p>
                                <button 
                                    onClick={() => isLoggedIn ? setCurrentPage('services') : setCurrentPage('login')} 
                                    className="bg-white text-indigo-600 px-6 py-3 rounded-lg font-bold hover:bg-indigo-100 transition duration-300"
                                >
                                    {isLoggedIn ? 'Book a Service' : 'Sign in to Book'}
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="grid md:grid-cols-2 gap-8 mb-8">
                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="text-indigo-600 text-4xl mb-4">
                                <i className="fas fa-broom"></i>
                            </div>
                            <h3 className="text-xl font-bold mb-2">House Cleaning</h3>
                            <p className="text-gray-600 mb-4">Professional cleaning services tailored to your needs. From basic cleaning to deep cleaning and move-out services.</p>
                            <button 
                                onClick={() => {
                                    setActiveService('cleaning');
                                    isLoggedIn ? setCurrentPage('services') : setCurrentPage('login');
                                }} 
                                className="text-indigo-600 font-semibold hover:underline"
                            >
                                View Cleaning Services →
                            </button>
                        </div>
                        <div className="bg-white p-6 rounded-lg shadow">
                            <div className="text-indigo-600 text-4xl mb-4">
                                <i className="fas fa-truck"></i>
                            </div>
                            <h3 className="text-xl font-bold mb-2">Moving Services</h3>
                            <p className="text-gray-600 mb-4">Reliable and efficient moving services to help you relocate with ease. Local and long-distance options available.</p>
                            <button 
                                onClick={() => {
                                    setActiveService('moving');
                                    isLoggedIn ? setCurrentPage('services') : setCurrentPage('login');
                                }} 
                                className="text-indigo-600 font-semibold hover:underline"
                            >
                                View Moving Services →
                            </button>
                        </div>
                    </div>

                    <div className="bg-gray-50 p-6 rounded-lg shadow mb-8">
                        <h3 className="text-xl font-bold mb-4">Customer Reviews</h3>
                        <div className="grid md:grid-cols-2 gap-4">
                            {demoReviews.map(review => {
                                const service = getServiceById(review.serviceId);
                                const user = demoUsers.find(u => u.id === review.userId);
                                return (
                                    <div key={review.id} className="bg-white p-4 rounded border">
                                        <div className="flex items-center mb-2">
                                            <div className="text-yellow-400">
                                                {[...Array(review.rating)].map((_, i) => (
                                                    <i key={i} className="fas fa-star"></i>
                                                ))}
                                                {[...Array(5-review.rating)].map((_, i) => (
                                                    <i key={i+review.rating} className="far fa-star"></i>
                                                ))}
                                            </div>
                                            <span className="ml-2 text-gray-600">{service.name}</span>
                                        </div>
                                        <p className="text-gray-700 mb-2">"{review.comment}"</p>
                                        <div className="text-gray-500 text-sm">
                                            - {user.name}, {review.date}
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>

                    <div className="bg-indigo-100 p-6 rounded-lg shadow text-center">
                        <h3 className="text-xl font-bold mb-2">Join Our Community</h3>
                        <p className="mb-4">Book services, chat with providers, and leave reviews.</p>
                        {!isLoggedIn && (
                            <button 
                                onClick={() => setCurrentPage('login')} 
                                className="bg-indigo-600 text-white px-6 py-2 rounded font-semibold hover:bg-indigo-700"
                            >
                                Sign Up Now
                            </button>
                        )}
                    </div>
                </div>
            );

            const LoginPage = () => {
                const [username, setUsername] = useState('');
                const [password, setPassword] = useState('');
                const [error, setError] = useState('');

                const handleLogin = (e) => {
                    e.preventDefault();
                    const success = login(username, password);
                    if (success) {
                        setCurrentPage('home');
                    } else {
                        setError('Invalid username or password');
                    }
                };

                return (
                    <div className="container mx-auto p-4 max-w-md">
                        <div className="bg-white p-8 rounded-lg shadow-lg">
                            <h2 className="text-2xl font-bold mb-6 text-center">Login to CleanMove</h2>
                            
                            {error && <div className="bg-red-100 text-red-700 p-3 rounded mb-4">{error}</div>}
                            
                            <form onSubmit={handleLogin}>
                                <div className="mb-4">
                                    <label className="block text-gray-700 mb-2">Username</label>
                                    <input 
                                        type="text" 
                                        className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                        value={username}
                                        onChange={(e) => setUsername(e.target.value)}
                                        required
                                    />
                                </div>
                                <div className="mb-6">
                                    <label className="block text-gray-700 mb-2">Password</label>
                                    <input 
                                        type="password" 
                                        className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                        value={password}
                                        onChange={(e) => setPassword(e.target.value)}
                                        required
                                    />
                                </div>
                                <button 
                                    type="submit" 
                                    className="w-full bg-indigo-600 text-white py-2 rounded font-semibold hover:bg-indigo-700"
                                >
                                    Login
                                </button>
                            </form>
                            
                            <div className="mt-6 text-center">
                                <p className="text-gray-600">Demo login: username "demo", password "password"</p>
                            </div>
                        </div>
                    </div>
                );
            };

            const ServicesPage = () => {
                const filteredServices = demoServices.filter(service => service.type === activeService);
                
                return (
                    <div className="container mx-auto p-4">
                        <h2 className="text-2xl font-bold mb-6">Available Services</h2>
                        
                        <div className="flex mb-6">
                            <button 
                                onClick={() => setActiveService('cleaning')}
                                className={`px-4 py-2 mr-2 rounded ${activeService === 'cleaning' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                            >
                                Cleaning Services
                            </button>
                            <button 
                                onClick={() => setActiveService('moving')}
                                className={`px-4 py-2 rounded ${activeService === 'moving' ? 'bg-indigo-600 text-white' : 'bg-gray-200'}`}
                            >
                                Moving Services
                            </button>
                        </div>
                        
                        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {filteredServices.map(service => {
                                const provider = getProviderById(service.providerId);
                                const reviews = getReviewsForService(service.id);
                                const avgRating = reviews.length > 0 
                                    ? reviews.reduce((acc, review) => acc + review.rating, 0) / reviews.length 
                                    : 0;
                                
                                return (
                                    <div key={service.id} className="bg-white rounded-lg shadow overflow-hidden">
                                        <div className={`h-2 ${service.type === 'cleaning' ? 'bg-blue-500' : 'bg-green-500'}`}></div>
                                        <div className="p-6">
                                            <h3 className="text-xl font-bold mb-2">{service.name}</h3>
                                            <p className="text-gray-600 mb-4">Duration: {service.duration}</p>
                                            <div className="flex justify-between items-center mb-4">
                                                <span className="text-2xl font-bold text-indigo-600">${service.price}</span>
                                                {avgRating > 0 && (
                                                    <div className="flex items-center">
                                                        <div className="text-yellow-400 mr-1">
                                                            {[...Array(Math.round(avgRating))].map((_, i) => (
                                                                <i key={i} className="fas fa-star"></i>
                                                            ))}
                                                        </div>
                                                        <span className="text-gray-600">({reviews.length})</span>
                                                    </div>
                                                )}
                                            </div>
                                            <div className="mb-4 text-sm text-gray-500">
                                                Provider: {provider.name}
                                            </div>
                                            <button 
                                                onClick={() => bookService(service)}
                                                className="w-full bg-indigo-600 text-white py-2 rounded font-semibold hover:bg-indigo-700"
                                            >
                                                Book Now
                                            </button>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const BookingPage = () => {
                if (!serviceToBook) return <div>Loading...</div>;
                
                return (
                    <div className="container mx-auto p-4 max-w-md">
                        <div className="bg-white p-6 rounded-lg shadow">
                            <h2 className="text-2xl font-bold mb-6">Book {serviceToBook.name}</h2>
                            
                            <div className="mb-4 p-3 bg-gray-50 rounded">
                                <div className="text-gray-700">Service: {serviceToBook.name}</div>
                                <div className="text-gray-700">Price: ${serviceToBook.price}</div>
                                <div className="text-gray-700">Duration: {serviceToBook.duration}</div>
                            </div>
                            
                            <div className="mb-4">
                                <label className="block text-gray-700 mb-2">Date</label>
                                <input 
                                    type="date" 
                                    className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                    value={bookingDetails.date}
                                    onChange={(e) => setBookingDetails({...bookingDetails, date: e.target.value})}
                                    required
                                />
                            </div>
                            
                            <div className="mb-4">
                                <label className="block text-gray-700 mb-2">Time</label>
                                <input 
                                    type="time" 
                                    className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                    value={bookingDetails.time}
                                    onChange={(e) => setBookingDetails({...bookingDetails, time: e.target.value})}
                                    required
                                />
                            </div>
                            
                            <div className="mb-6">
                                <label className="block text-gray-700 mb-2">Address</label>
                                <textarea
                                    className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                    value={bookingDetails.address}
                                    onChange={(e) => setBookingDetails({...bookingDetails, address: e.target.value})}
                                    rows="3"
                                    required
                                ></textarea>
                            </div>
                            
                            <div className="flex space-x-4">
                                <button 
                                    onClick={() => setCurrentPage('services')}
                                    className="flex-1 bg-gray-300 text-gray-800 py-2 rounded font-semibold hover:bg-gray-400"
                                >
                                    Cancel
                                </button>
                                <button 
                                    onClick={confirmBooking}
                                    className="flex-1 bg-indigo-600 text-white py-2 rounded font-semibold hover:bg-indigo-700"
                                >
                                    Confirm Booking
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            const BookingsPage = () => {
                const userBookings = getUserBookings();
                
                return (
                    <div className="container mx-auto p-4">
                        <h2 className="text-2xl font-bold mb-6">My Bookings</h2>
                        
                        {userBookings.length === 0 ? (
                            <div className="bg-white p-6 rounded-lg shadow text-center">
                                <p className="text-gray-600 mb-4">You don't have any bookings yet.</p>
                                <button 
                                    onClick={() => setCurrentPage('services')}
                                    className="bg-indigo-600 text-white px-6 py-2 rounded font-semibold hover:bg-indigo-700"
                                >
                                    Book a Service
                                </button>
                            </div>
                        ) : (
                            <div className="space-y-4">
                                {userBookings.map(booking => {
                                    const service = getServiceById(booking.serviceId);
                                    const provider = getProviderById(service.providerId);
                                    
                                    return (
                                        <div key={booking.id} className="bg-white p-6 rounded-lg shadow">
                                            <div className="flex justify-between items-center mb-4">
                                                <h3 className="text-xl font-semibold">{service.name}</h3>
                                                <span className={`px-3 py-1 rounded text-sm font-semibold ${
                                                    booking.status === 'confirmed' ? 'bg-green-100 text-green-800' : 
                                                    booking.status === 'pending' ? 'bg-yellow-100 text-yellow-800' : 
                                                    'bg-red-100 text-red-800'
                                                }`}>
                                                    {booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}
                                                </span>
                                            </div>
                                            
                                            <div className="grid md:grid-cols-2 gap-4 mb-4">
                                                <div>
                                                    <p className="text-gray-600"><strong>Date:</strong> {booking.date}</p>
                                                    <p className="text-gray-600"><strong>Time:</strong> {booking.time}</p>
                                                    <p className="text-gray-600"><strong>Provider:</strong> {provider.name}</p>
                                                </div>
                                                <div>
                                                    <p className="text-gray-600"><strong>Address:</strong> {booking.address}</p>
                                                    <p className="text-gray-600"><strong>Price:</strong> ${service.price}</p>
                                                </div>
                                            </div>
                                            
                                            <div className="flex space-x-2">
                                                <button 
                                                    onClick={() => {
                                                        // Find chat with this provider or create one
                                                        let chat = demoChats.find(c => 
                                                            c.participants.includes(currentUser.id) && 
                                                            c.participants.includes(provider.id)
                                                        );
                                                        
                                                        if (!chat) {
                                                            chat = {
                                                                id: demoChats.length + 1,
                                                                participants: [currentUser.id, provider.id],
                                                                messages: []
                                                            };
                                                            demoChats.push(chat);
                                                        }
                                                        
                                                        setActiveChatId(chat.id);
                                                        setCurrentPage('chats');
                                                    }}
                                                    className="bg-indigo-100 text-indigo-700 px-4 py-2 rounded font-semibold hover:bg-indigo-200"
                                                >
                                                    <i className="fas fa-comment mr-2"></i> Contact Provider
                                                </button>
                                                {booking.status === 'confirmed' && (
                                                    <button 
                                                        className="bg-green-100 text-green-700 px-4 py-2 rounded font-semibold hover:bg-green-200"
                                                    >
                                                        <i className="fas fa-star mr-2"></i> Leave Review
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        )}
                    </div>
                );
            };

            const ChatsPage = () => {
                const userChats = getUserChats();
                
                return (
                    <div className="container mx-auto p-4">
                        <h2 className="text-2xl font-bold mb-6">Messages</h2>
                        
                        {userChats.length === 0 ? (
                            <div className="bg-white p-6 rounded-lg shadow text-center">
                                <p className="text-gray-600">You don't have any messages yet.</p>
                            </div>
                        ) : (
                            <div className="bg-white rounded-lg shadow overflow-hidden">
                                <div className="flex h-96">
                                    {/* Chat list */}
                                    <div className="w-1/3 border-r">
                                        <div className="p-4 border-b bg-gray-50">
                                            <h3 className="font-semibold">Conversations</h3>
                                        </div>
                                        <div className="overflow-y-auto h-80">
                                            {userChats.map(chat => (
                                                <div 
                                                    key={chat.id} 
                                                    className={`p-4 border-b cursor-pointer hover:bg-gray-50 ${activeChatId === chat.id ? 'bg-indigo-50' : ''}`}
                                                    onClick={() => setActiveChatId(chat.id)}
                                                >
                                                    <div className="font-semibold">{getChatParticipantName(chat)}</div>
                                                    <div className="text-sm text-gray-500 truncate">
                                                        {chat.messages.length > 0 
                                                            ? `${chat.messages[chat.messages.length - 1].text.substring(0, 30)}${chat.messages[chat.messages.length - 1].text.length > 30 ? '...' : ''}`
                                                            : 'No messages yet'
                                                        }
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    
                                    {/* Chat messages */}
                                    <div className="w-2/3 flex flex-col">
                                        {activeChatId ? (
                                            <>
                                                <div className="p-4 border-b bg-gray-50">
                                                    <h3 className="font-semibold">
                                                        {getChatParticipantName(demoChats.find(chat => chat.id === activeChatId))}
                                                    </h3>
                                                </div>
                                                <div className="flex-1 overflow-y-auto p-4 space-y-3">
                                                    {demoChats.find(chat => chat.id === activeChatId)?.messages.map((msg, idx) => {
                                                        const isCurrentUser = msg.sender === currentUser.id;
                                                        const sender = demoUsers.find(user => user.id === msg.sender);
                                                        
                                                        return (
                                                            <div key={idx} className={`flex ${isCurrentUser ? 'justify-end' : 'justify-start'}`}>
                                                                <div className={`max-w-xs p-3 rounded-lg ${isCurrentUser ? 'bg-indigo-100' : 'bg-gray-100'}`}>
                                                                    <div className="text-sm">
                                                                        {msg.text}
                                                                    </div>
                                                                    <div className="text-xs text-gray-500 mt-1">
                                                                        {msg.timestamp}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                                <div className="p-4 border-t">
                                                    <div className="flex">
                                                        <input 
                                                            type="text" 
                                                            className="flex-1 p-2 border rounded-l focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                            placeholder="Type a message..."
                                                            value={chatMessage}
                                                            onChange={(e) => setChatMessage(e.target.value)}
                                                            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
                                                        />
                                                        <button 
                                                            onClick={sendMessage}
                                                            className="bg-indigo-600 text-white px-4 rounded-r hover:bg-indigo-700"
                                                        >
                                                            <i className="fas fa-paper-plane"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </>
                                        ) : (
                                            <div className="flex-1 flex items-center justify-center text-gray-500">
                                                Select a conversation to start chatting
                                            </div>
                                        )}
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                );
            };

            // Community and Reviews Page
            const CommunityPage = () => {
                const [selectedService, setSelectedService] = useState(null);
                const [reviewText, setReviewText] = useState('');
                const [reviewRating, setReviewRating] = useState(5);
                
                return (
                    <div className="container mx-auto p-4">
                        <h2 className="text-2xl font-bold mb-6">Community & Reviews</h2>
                        
                        <div className="grid md:grid-cols-3 gap-6">
                            <div className="md:col-span-2">
                                <div className="bg-white p-6 rounded-lg shadow mb-6">
                                    <h3 className="text-xl font-bold mb-4">Recent Reviews</h3>
                                    
                                    {demoReviews.map(review => {
                                        const service = getServiceById(review.serviceId);
                                        const user = demoUsers.find(u => u.id === review.userId);
                                        const provider = getProviderById(service.providerId);
                                        
                                        return (
                                            <div key={review.id} className="border-b last:border-b-0 py-4">
                                                <div className="flex justify-between items-start">
                                                    <div>
                                                        <div className="text-yellow-400 mb-1">
                                                            {[...Array(review.rating)].map((_, i) => (
                                                                <i key={i} className="fas fa-star"></i>
                                                            ))}
                                                            {[...Array(5-review.rating)].map((_, i) => (
                                                                <i key={i+review.rating} className="far fa-star"></i>
                                                            ))}
                                                        </div>
                                                        <h4 className="font-semibold">{service.name}</h4>
                                                        <p className="text-gray-600 text-sm">Provider: {provider.name}</p>
                                                    </div>
                                                    <div className="text-sm text-gray-500">
                                                        {review.date}
                                                    </div>
                                                </div>
                                                <p className="my-2 text-gray-700">"{review.comment}"</p>
                                                <div className="text-sm text-gray-600">
                                                    - {user.name}
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                            
                            <div>
                                <div className="bg-white p-6 rounded-lg shadow sticky top-4">
                                    <h3 className="font-bold mb-4">Write a Review</h3>
                                    
                                    {isLoggedIn ? (
                                        <>
                                            <div className="mb-4">
                                                <label className="block text-gray-700 mb-2">Select Service</label>
                                                <select 
                                                    className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    value={selectedService || ''}
                                                    onChange={(e) => setSelectedService(Number(e.target.value))}
                                                >
                                                    <option value="">Select a service...</option>
                                                    {demoServices.map(service => (
                                                        <option key={service.id} value={service.id}>
                                                            {service.name}
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>
                                            
                                            <div className="mb-4">
                                                <label className="block text-gray-700 mb-2">Rating</label>
                                                <div className="flex text-2xl text-yellow-400">
                                                    {[...Array(5)].map((_, i) => (
                                                        <i 
                                                            key={i} 
                                                            className={`${i < reviewRating ? 'fas' : 'far'} fa-star cursor-pointer`}
                                                            onClick={() => setReviewRating(i + 1)}
                                                        ></i>
                                                    ))}
                                                </div>
                                            </div>
                                            
                                            <div className="mb-4">
                                                <label className="block text-gray-700 mb-2">Your Review</label>
                                                <textarea
                                                    className="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-indigo-400"
                                                    rows="4"
                                                    value={reviewText}
                                                    onChange={(e) => setReviewText(e.target.value)}
                                                    placeholder="Share your experience..."
                                                ></textarea>
                                            </div>
                                            
                                            <button 
                                                className="w-full bg-indigo-600 text-white py-2 rounded font-semibold hover:bg-indigo-700"
                                                onClick={() => {
                                                    if (!selectedService || !reviewText.trim()) {
                                                        alert('Please select a service and write a review');
                                                        return;
                                                    }
                                                    
                                                    // In a real app, we would send this to the server
                                                    alert('Review submitted successfully!');
                                                    setSelectedService(null);
                                                    setReviewText('');
                                                    setReviewRating(5);
                                                }}
                                            >
                                                Submit Review
                                            </button>
                                        </>
                                    ) : (
                                        <div className="text-center">
                                            <p className="text-gray-600 mb-4">Please login to write a review.</p>
                                            <button 
                                                onClick={() => setCurrentPage('login')}
                                                className="bg-indigo-600 text-white px-4 py-2 rounded font-semibold hover:bg-indigo-700"
                                            >
                                                Login Now
                                            </button>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            // Render the current page
            const renderPage = () => {
                switch(currentPage) {
                    case 'home': return <HomePage />;
                    case 'login': return <LoginPage />;
                    case 'services': return <ServicesPage />;
                    case 'booking': return <BookingPage />;
                    case 'bookings': return <BookingsPage />;
                    case 'chats': return <ChatsPage />;
                    case 'community': return <CommunityPage />;
                    default: return <HomePage />;
                }
            };

            return (
                <div className="min-h-screen bg-gray-100">
                    <Navigation />
                    {renderPage()}
                    <footer className="bg-gray-800 text-white p-6 mt-8">
                        <div className="container mx-auto">
                            <div className="flex flex-col md:flex-row justify-between">
                                <div className="mb-6 md:mb-0">
                                    <h2 className="text-2xl font-bold mb-4">CleanMove</h2>
                                    <p className="text-gray-400">Professional Cleaning & Moving Services</p>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-3 gap-8">
                                    <div>
                                        <h3 className="font-semibold mb-4">Services</h3>
                                        <ul className="space-y-2 text-gray-400">
                                            <li><a href="#" className="hover:text-white">House Cleaning</a></li>
                                            <li><a href="#" className="hover:text-white">Deep Cleaning</a></li>
                                            <li><a href="#" className="hover:text-white">Moving Services</a></li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h3 className="font-semibold mb-4">Company</h3>
                                        <ul className="space-y-2 text-gray-400">
                                            <li><a href="#" className="hover:text-white">About Us</a></li>
                                            <li><a href="#" className="hover:text-white">How It Works</a></li>
                                            <li><a href="#" className="hover:text-white">Contact</a></li>
                                        </ul>
                                    </div>
                                    <div>
                                        <h3 className="font-semibold mb-4">Legal</h3>
                                        <ul className="space-y-2 text-gray-400">
                                            <li><a href="#" className="hover:text-white">Privacy Policy</a></li>
                                            <li><a href="#" className="hover:text-white">Terms of Service</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div className="mt-8 pt-8 border-t border-gray-700 text-gray-400 text-sm text-center">
                                &copy; 2025 CleanMove. All rights reserved.
                            </div>
                        </div>
                    </footer>
                </div>
            );
        }

        // Render the React app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>